var show_sep_history = ( function(){

  function parentRow(){
    var $parent_row = $(".table:first > tbody > tr:not(tr.child-row)").eq(<%= @row %>);
    if ( $('tr.child-row:visible').length > 0 ) {
      $('tr.child-row:visible').remove();
      $("li>a:contains('Collapse Form')").addClass('disabled');
    }
    if ( $parent_row.next().hasClass('child-row') ) {
    } 
    else {
      $parent_row.after('<tr class="child-row"><td colspan="100"><%= j render partial: "sep_history/index", 
      person_id: @family.primary_applicant.person.id, family_id: @family %></td></tr>');
      $("li>a:contains('Collapse Form')").eq(<%= @row %>).removeClass('disabled');
      $('.dropdown.pull-right').removeClass('open');
    }
  }

  return{
    parentRow: parentRow
  }
})();
show_sep_history.parentRow();